(this.webpackJsonpvchatapp=this.webpackJsonpvchatapp||[]).push([[0],{101:function(e,t,n){},135:function(e,t){},137:function(e,t){},146:function(e,t,n){},148:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(11),s=n.n(i),r=(n(101),n(13)),o=n(180),l=n(184),j=n(185),u=n(88),d=n.n(u),b=n(87),O=n.n(b),f=n(64),m=n.n(f),v=n(24),h=n(81),x=n(83),g=n.n(x),p=n(5);var S=function(e){var t=e.socket,n=e.name,a=e.room,i=Object(c.useState)(""),s=Object(r.a)(i,2),l=s[0],j=s[1],u=Object(c.useState)([]),d=Object(r.a)(u,2),b=d[0],O=d[1],f=n,x=function(){var e=Object(h.a)(m.a.mark((function e(){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===l){e.next=5;break}return c={room:a,author:n,message:l,time:new Date(Date.now()).getHours()+":"+new Date(Date.now()).getMinutes()},e.next=4,t.emit("sendMessage",c);case 4:O((function(e){return[].concat(Object(v.a)(e),[c])}));case 5:document.getElementById("inp").value="";case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){t.on("recieveMessage",(function(e){O((function(t){return[].concat(Object(v.a)(t),[e])}))}))}),[t]),Object(p.jsxs)("div",{id:"chat-container",children:[b.map((function(e){return e.author===f?Object(p.jsx)("div",{id:"user-box",children:Object(p.jsx)("h3",{id:"user-msg",children:e.message})}):Object(p.jsx)("div",{id:"peer-box",children:Object(p.jsx)("h3",{id:"peer-msg",children:e.message})})})),Object(p.jsxs)("div",{id:"chat-footer",children:[Object(p.jsx)("input",{id:"inp",placeholder:"Message",onChange:function(e){j(e.target.value)}}),""!==l&&Object(p.jsx)(o.a,{onClick:x,startIcon:Object(p.jsx)(g.a,{fontSize:"medium",id:"send"})})]})]})},y=(n(108),n(56)),C=n.n(y),w=n(89),k=(n(146),w.a.connect("http://localhost:3002"));var I=function(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(!0),s=Object(r.a)(i,2),u=s[0],b=s[1],f=Object(c.useState)(),m=Object(r.a)(f,2),v=m[0],h=m[1],x=Object(c.useState)(!1),g=Object(r.a)(x,2),y=g[0],w=g[1],I=Object(c.useState)(""),N=Object(r.a)(I,2),D=N[0],M=N[1],B=Object(c.useState)(),E=Object(r.a)(B,2),R=E[0],F=E[1],P=Object(c.useState)(!1),T=Object(r.a)(P,2),z=T[0],A=T[1],U=Object(c.useState)(""),J=Object(r.a)(U,2),L=J[0],H=J[1],q=Object(c.useState)(!1),G=Object(r.a)(q,2),K=G[0],Q=G[1],V=Object(c.useState)(""),W=Object(r.a)(V,2),X=W[0],Y=W[1],Z=Object(c.useState)(""),$=Object(r.a)(Z,2),_=$[0],ee=$[1],te=Object(c.useRef)(),ne=Object(c.useRef)(),ce=Object(c.useRef)();return Object(c.useEffect)((function(){b(!0),k.on("me",(function(e){a(e)})),k.on("callUser",(function(e){w(!0),M(e.from),Y(e.name),F(e.signal)}))}),[]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("div",{className:"container",children:[Object(p.jsxs)("div",{className:"video-container",children:[Object(p.jsx)("div",{className:"video",children:v&&Object(p.jsx)("video",{playsInline:!0,muted:!0,ref:te,autoPlay:!0,style:{width:"300px"}})}),Object(p.jsx)("div",{className:"video",children:z&&!K?Object(p.jsx)("video",{playsInline:!0,ref:ne,autoPlay:!0,style:{width:"300px"}}):null})]}),Object(p.jsxs)("div",{className:"myId",children:[Object(p.jsx)("div",{id:"permission",children:Object(p.jsx)(o.a,{id:"permit",onClick:function(){b(!0!==u),console.log(u),!0===u?navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){h(e),te.current.srcObject=e})):!1===u&&h(null)},startIcon:Object(p.jsx)(O.a,{fontSize:"large"})})}),Object(p.jsx)(j.a,{id:"filled-basic",label:"Name",variant:"filled",value:X,onChange:function(e){return Y(e.target.value)},style:{marginBottom:"20px"}}),Object(p.jsx)("p",{children:n}),Object(p.jsx)(j.a,{id:"filled-basic",label:"ID to call",variant:"filled",value:L,onChange:function(e){return H(e.target.value)}}),Object(p.jsxs)("div",{style:{display:"flex"},children:[Object(p.jsx)(j.a,{id:"filled-basic",label:"Room",variant:"filled",value:_,onChange:function(e){return ee(e.target.value)},style:{marginBottom:"20px",marginTop:"10px"}}),Object(p.jsx)(o.a,{onClick:function(){return function(e){""!==e&&""!==X&&k.emit("joinRoom",e)}(_)},id:"join",color:"red",children:"join"})]}),Object(p.jsxs)("div",{className:"call-button",children:[z&&!K?Object(p.jsx)(o.a,{variant:"contained",color:"secondary",onClick:function(){Q(!0);var e=new C.a;e.on("stream",(function(t){e.removeStream(t)})),ce.current.destroy()},children:"End Call"}):Object(p.jsx)(l.a,{color:"primary","aria-label":"call",onClick:function(){return function(e){var t=new C.a({initiator:!0,trickle:!1,stream:v});t.on("signal",(function(t){k.emit("callUser",{userToCall:e,signalData:t,from:n,name:X})})),t.on("stream",(function(e){ne.current.srcObject=e})),k.on("callAccepted",(function(e){A(!0),t.signal(e)})),ce.current=t}(L)},children:Object(p.jsx)(d.a,{fontSize:"large"})}),L]})]}),Object(p.jsx)("div",{children:y&&!z?Object(p.jsxs)("div",{className:"caller",children:[Object(p.jsxs)("h1",{children:[X," is calling..."]}),Object(p.jsx)(o.a,{variant:"contained",color:"primary",onClick:function(){A(!0),console.log("hi");var e=new C.a({initiator:!1,trickle:!1,stream:v});e.on("signal",(function(e){k.emit("answerCall",{signal:e,to:D})})),e.on("stream",(function(e){ne.current.srcObject=e})),e.signal(R),ce.current=e},children:"Answer"})]}):null})]}),Object(p.jsx)(S,{socket:k,name:X,room:_})]})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,187)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(I,{})}),document.getElementById("root")),N()}},[[148,1,2]]]);
//# sourceMappingURL=main.564cf7a4.chunk.js.map