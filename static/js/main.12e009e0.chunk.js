(this.webpackJsonpvchatapp=this.webpackJsonpvchatapp||[]).push([[0],{103:function(e,t,n){},136:function(e,t){},138:function(e,t){},147:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(11),r=n.n(i),s=(n(103),n(13)),o=n(180),l=n(184),j=n(185),u=n(89),d=n.n(u),b=n(90),O=n.n(b),f=n(88),m=n.n(f),v=n(64),h=n.n(v),x=n(24),g=n(81),p=n(83),y=n.n(p),S=n(4);var C=function(e){var t=e.socket,n=e.name,a=e.room,i=Object(c.useState)(""),r=Object(s.a)(i,2),l=r[0],j=r[1],u=Object(c.useState)([]),d=Object(s.a)(u,2),b=d[0],O=d[1],f=n,m=function(){var e=Object(g.a)(h.a.mark((function e(){var c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===l){e.next=5;break}return c={room:a,author:n,message:l,time:new Date(Date.now()).getHours()+":"+new Date(Date.now()).getMinutes()},e.next=4,t.emit("sendMessage",c);case 4:O((function(e){return[].concat(Object(x.a)(e),[c])}));case 5:document.getElementById("inp").value="";case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){t.on("recieveMessage",(function(e){O((function(t){return[].concat(Object(x.a)(t),[e])}))}))}),[t]),Object(S.jsxs)("div",{id:"chat-container",children:[b.map((function(e){return e.author===f?Object(S.jsx)("div",{id:"user-box",children:Object(S.jsx)("h3",{id:"user-msg",children:e.message})}):Object(S.jsx)("div",{id:"peer-box",children:Object(S.jsx)("h3",{id:"peer-msg",children:e.message})})})),Object(S.jsxs)("div",{id:"chat-footer",children:[Object(S.jsx)("input",{id:"inp",placeholder:"Message",onChange:function(e){j(e.target.value)}}),""!==l&&Object(S.jsx)(o.a,{onClick:m,startIcon:Object(S.jsx)(y.a,{fontSize:"medium",id:"send"})})]})]})},w=n(84),k=n(59),I=n.n(k),D=n(91),N=(n(147),D.a.connect("http://localhost:3002"));var B=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(!0),r=Object(s.a)(i,2),u=r[0],b=r[1],f=Object(c.useState)(),v=Object(s.a)(f,2),h=v[0],x=v[1],g=Object(c.useState)(!1),p=Object(s.a)(g,2),y=p[0],k=p[1],D=Object(c.useState)(""),B=Object(s.a)(D,2),M=B[0],E=B[1],R=Object(c.useState)(),T=Object(s.a)(R,2),z=T[0],F=T[1],P=Object(c.useState)(!1),A=Object(s.a)(P,2),U=A[0],J=A[1],L=Object(c.useState)(""),H=Object(s.a)(L,2),q=H[0],G=H[1],K=Object(c.useState)(!1),Q=Object(s.a)(K,2),V=Q[0],W=Q[1],X=Object(c.useState)(""),Y=Object(s.a)(X,2),Z=Y[0],$=Y[1],_=Object(c.useState)(""),ee=Object(s.a)(_,2),te=ee[0],ne=ee[1],ce=Object(c.useRef)(),ae=Object(c.useRef)(),ie=Object(c.useRef)();return Object(c.useEffect)((function(){b(!0),N.on("me",(function(e){a(e)})),N.on("callUser",(function(e){k(!0),E(e.from),$(e.name),F(e.signal)}))}),[]),Object(S.jsxs)("div",{className:"App",children:[Object(S.jsxs)("div",{className:"container",children:[Object(S.jsxs)("div",{className:"video-container",children:[Object(S.jsx)("div",{className:"video",children:h&&Object(S.jsx)("video",{playsInline:!0,muted:!0,ref:ce,autoPlay:!0,style:{width:"300px"}})}),Object(S.jsx)("div",{className:"video",children:U&&!V?Object(S.jsx)("video",{playsInline:!0,ref:ae,autoPlay:!0,style:{width:"300px"}}):null})]}),Object(S.jsxs)("div",{className:"myId",children:[Object(S.jsx)("div",{id:"permission",children:Object(S.jsx)(o.a,{id:"permit",onClick:function(){b(!0!==u),console.log(u),!0===u?navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){x(e),ce.current.srcObject=e})):!1===u&&x(null)},startIcon:Object(S.jsx)(m.a,{fontSize:"large"})})}),Object(S.jsx)(j.a,{id:"filled-basic",label:"Name",variant:"filled",value:Z,onChange:function(e){return $(e.target.value)},style:{marginBottom:"20px"}}),Object(S.jsx)(w.CopyToClipboard,{text:n,style:{marginBottom:"2rem"},children:Object(S.jsx)(o.a,{variant:"contained",color:"primary",startIcon:Object(S.jsx)(d.a,{fontSize:"large"}),children:"Copy ID"})}),Object(S.jsx)("div",{children:n}),Object(S.jsx)(j.a,{id:"filled-basic",label:"ID to call",variant:"filled",value:q,onChange:function(e){return G(e.target.value)}}),Object(S.jsxs)("div",{style:{display:"flex"},children:[Object(S.jsx)(j.a,{id:"filled-basic",label:"Room",variant:"filled",value:te,onChange:function(e){return ne(e.target.value)},style:{marginBottom:"20px",marginTop:"10px"}}),Object(S.jsx)(o.a,{onClick:function(){return function(e){""!==e&&""!==Z&&N.emit("joinRoom",e)}(te)},id:"join",color:"red",children:"join"})]}),Object(S.jsxs)("div",{className:"call-button",children:[U&&!V?Object(S.jsx)(o.a,{variant:"contained",color:"secondary",onClick:function(){W(!0);var e=new I.a;e.on("stream",(function(t){e.removeStream(t)})),ie.current.destroy()},children:"End Call"}):Object(S.jsx)(l.a,{color:"primary","aria-label":"call",onClick:function(){return function(e){var t=new I.a({initiator:!0,trickle:!1,stream:h});t.on("signal",(function(t){N.emit("callUser",{userToCall:e,signalData:t,from:n,name:Z})})),t.on("stream",(function(e){ae.current.srcObject=e})),N.on("callAccepted",(function(e){J(!0),t.signal(e)})),ie.current=t}(q)},children:Object(S.jsx)(O.a,{fontSize:"large"})}),q]})]}),Object(S.jsx)("div",{children:y&&!U?Object(S.jsxs)("div",{className:"caller",children:[Object(S.jsxs)("h1",{children:[Z," is calling..."]}),Object(S.jsx)(o.a,{variant:"contained",color:"primary",onClick:function(){J(!0),console.log("hi");var e=new I.a({initiator:!1,trickle:!1,stream:h});e.on("signal",(function(e){N.emit("answerCall",{signal:e,to:M})})),e.on("stream",(function(e){ae.current.srcObject=e})),e.signal(z),ie.current=e},children:"Answer"})]}):null})]}),Object(S.jsx)(C,{socket:N,name:Z,room:te})]})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,187)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};r.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(B,{})}),document.getElementById("root")),M()}},[[149,1,2]]]);
//# sourceMappingURL=main.12e009e0.chunk.js.map